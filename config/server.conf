# =============================================================================
# SecureSeaHorse Server Configuration â€” v1.2.0 (Phase 2)
# =============================================================================

# --- Network ---
port = 65432

# --- mTLS Certificates ---
ca_path     = certs/ca.crt
server_crt  = certs/server.crt
server_key  = certs/server.key

# --- Logging ---
log_file        = server.log

# --- Legacy Storage (CSV) ---
# Set to "none" to disable CSV output entirely
csv_output = s_log.csv

# --- [Phase 1] Log Rotation ---
log_max_bytes   = 10485760    # 10 MB before rotation
log_max_files   = 5           # Keep server.log.1 through server.log.5

# --- [Phase 1] Dynamic Thread Pool ---
pool_min            = 2       # Minimum worker threads (always alive)
pool_max            = 32      # Maximum worker threads under load
pool_idle_timeout_s = 30      # Seconds before idle excess workers exit

# =============================================================================
# PHASE 2: Data Intelligence
# =============================================================================

# --- PostgreSQL Persistence ---
db_enabled  = true            # Set false to disable DB (CSV-only mode)
db_host     = 127.0.0.1
db_port     = 5432
db_name     = seahorse
db_user     = seahorse
db_pass     =                 # Empty = peer/trust auth

# --- Regex Engine ---
rules_file  = rules.conf      # Path to user-defined detection rules
                               # Built-in rules are always active regardless

# --- Threshold Alerting ---
alert_enabled = true           # Set false to disable alerting entirely
alert_log     = alerts.log     # Dedicated alert log (separate from server.log)

# Alert threshold overrides (format: count,window_sec,cooldown_sec)
# Uncomment and adjust to tune sensitivity:
# alert_threshold_auth_failure         = 5,300,600
# alert_threshold_brute_force          = 3,60,300
# alert_threshold_privilege_escalation = 2,120,600
# alert_threshold_account_lockout      = 1,60,900
# alert_threshold_resource_exhaustion  = 1,60,600
# alert_threshold_crash                = 2,300,600
