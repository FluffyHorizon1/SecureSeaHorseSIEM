# =============================================================================
# SecureSeaHorse Server Configuration â€” v1.6.0 (Phase 6)
# =============================================================================

# --- Network ---
port = 65432

# --- mTLS Certificates ---
ca_path     = certs/ca.crt
server_crt  = certs/server.crt
server_key  = certs/server.key

# --- Logging ---
log_file      = server.log
log_max_bytes = 10485760
log_max_files = 5

# --- Legacy Storage (CSV) ---
csv_output = s_log.csv

# --- [Phase 1] Dynamic Thread Pool ---
pool_min            = 2
pool_max            = 32
pool_idle_timeout_s = 30

# =============================================================================
# PHASE 2: Data Intelligence
# =============================================================================

# --- PostgreSQL Persistence ---
db_enabled  = true
db_host     = 127.0.0.1
db_port     = 5432
db_name     = seahorse
db_user     = seahorse
db_pass     =

# --- Regex Engine ---
rules_file  = rules.conf

# --- Threshold Alerting ---
alert_enabled = true
alert_log     = alerts.log
# alert_threshold_auth_failure = 5,300,600

# =============================================================================
# PHASE 3: Security & Lifecycle
# =============================================================================

hmac_enabled         = true
connection_timeout_s = 120
crl_path             =
ocsp_stapling        = false

# =============================================================================
# PHASE 4: Traffic Classification & Exploit Detection
# =============================================================================

# --- Master Switch ---
classifier_enabled = true

# --- Baseline Learning ---
# Alpha: EWMA learning rate (0.01=slow, 0.1=fast). Lower = more stable baseline.
cls_baseline_alpha  = 0.05
# Warmup: minimum samples before baselines are trusted (avoids cold-start false positives)
cls_baseline_warmup = 20

# --- Z-Score Anomaly Thresholds ---
# How many standard deviations from baseline = anomaly
cls_z_high   = 3.0    # Critical threshold
cls_z_medium = 2.5    # High threshold
cls_z_low    = 2.0    # Medium threshold (informational)

# --- DDoS Detection ---
cls_ddos_inbound_z         = 3.0         # Z-score for inbound traffic spike
cls_ddos_inbound_abs_bytes = 100000000   # Absolute ceiling: 100MB/interval

# --- Port Scan Detection ---
cls_portscan_refused_min = 10   # Min "connection refused" entries to flag

# --- Brute Force Detection ---
cls_brute_min_failures = 5      # Min auth failures per interval

# --- Data Exfiltration Detection ---
cls_exfil_outbound_z         = 3.0       # Z-score for outbound spike
cls_exfil_outbound_abs_bytes = 50000000  # Absolute ceiling: 50MB/interval

# --- C2 Beaconing Detection ---
# Coefficient of variation threshold for report intervals.
# Lower = more regular intervals = more suspicious.
cls_c2_jitter_max = 0.15

# =============================================================================
# PHASE 5: Threat Intelligence Feeds
# =============================================================================

# --- Master Switch ---
threat_intel_enabled = true

# --- Feed Directory ---
# Path to directory containing .csv feed files.
# All .csv files in this directory are loaded automatically.
feeds_dir = feeds

# --- Auto-Reload ---
# How often (seconds) to check feed files for modifications.
# Set to 0 to disable auto-reload (manual reload only).
feeds_reload_interval_s = 300

# =============================================================================
# PHASE 6: File Integrity Monitoring (Server-Side)
# =============================================================================

# --- Master Switch ---
fim_enabled = true

# --- Severity Classification ---
# Default severity for file changes not matching critical/high path patterns.
fim_default_severity = medium

# --- Custom Critical Paths (comma-separated regex patterns) ---
# Changes to files matching these patterns are always "critical".
# Built-in critical paths (always active): /etc/passwd, /etc/shadow, /boot, etc.
# fim_critical_paths = /opt/myapp/config,/home/admin/.ssh

# --- Custom High Paths (comma-separated regex patterns) ---
# Changes to files matching these patterns are always "high".
# Built-in high paths (always active): /var/www, /etc/nginx, etc.
# fim_high_paths = /opt/myapp/data,/srv/
