# =============================================================================
# SecureSeaHorse Client Configuration — v1.6.0 (Phase 6)
# =============================================================================

# --- Network ---
server_ip = 127.0.0.1
port      = 65432
device_id = 7001

# --- mTLS Certificates ---
ca_path     = certs/ca.crt
client_crt  = certs/client.crt
client_key  = certs/client.key

# --- Logging ---
log_file      = client.log
log_max_bytes = 10485760
log_max_files = 5

# --- [Phase 1] Exponential Backoff ---
backoff_base_ms = 1000
backoff_max_ms  = 60000

# =============================================================================
# PHASE 3: Security & Lifecycle
# =============================================================================

# --- HMAC Payload Integrity ---
# Replace CRC32 with HMAC-SHA256 (protocol v2). Both sides derive
# the HMAC key from the TLS session — no shared secret to manage.
hmac_enabled = true

# --- Heartbeat Keep-Alive ---
# Client sends a ping every heartbeat_interval_s seconds.
# If no pong arrives within heartbeat_timeout_s, force reconnect.
heartbeat_interval_s = 15
heartbeat_timeout_s  = 45

# --- Certificate Revocation (CRL) ---
# Path to a PEM-formatted CRL file. Leave empty to skip CRL checking.
crl_path =

# --- OCSP Stapling ---
# Request the server to staple an OCSP response during TLS handshake.
# If ocsp_must_staple=true, reject connections without a valid stapled response.
ocsp_stapling    = true
ocsp_must_staple = false

# --- Certificate Pinning ---
# SHA-256 fingerprint of the expected server certificate.
# Format: AA:BB:CC:... (uppercase hex, colon-separated)
# Leave empty to disable pinning.
cert_pin_sha256 =

# =============================================================================
# PHASE 6: File Integrity Monitoring (FIM)
# =============================================================================

# --- Master Switch ---
fim_enabled = true

# --- Scan Interval ---
# Seconds between full FIM scans. Lower = more responsive, higher = less CPU.
fim_scan_interval_s = 300

# --- Watch Paths ---
# Comma-separated list of directories/files to monitor.
# Defaults: /etc,/usr/sbin (Linux) or System32\drivers\etc,System32\config (Windows)
# fim_watch_paths = /etc,/usr/sbin,/boot,/var/www

# --- Exclusions ---
# File extensions to skip (comma-separated)
# fim_exclude_ext = .tmp,.log,.swp,.pyc

# --- Limits ---
fim_max_file_size = 104857600
fim_max_files     = 50000
fim_max_depth     = 20
